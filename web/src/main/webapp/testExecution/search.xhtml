<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:rich="http://richfaces.org/rich" xmlns:a4j="http://richfaces.org/a4j">
<h:body>
	<f:metadata>
		<f:event type="preRenderView" listener="#{searchController.preRender}" />
	</f:metadata>
	<ui:composition template="/layout/template.xhtml">
		<ui:define name="title">Search Test Execution</ui:define>
		<ui:define name="content">
			<h:form id="criteriaForm" class="form-horizontal well">
				<fieldset>
					<legend>Search Test Execution</legend>
					<div class="control-group">
						<h:outputLabel class="control-label" for="testName">Test Name</h:outputLabel>
						<div class="controls">
							<h:inputText type="text" class="input-xlarge" id="testName" value="#{searchController.criteria.testName}" />
						</div>
					</div>

					<div class="control-group">
						<h:outputLabel class="control-label" for="testUID">Test UID</h:outputLabel>
						<div class="controls">
							<h:inputText class="input-xlarge" id="testUID" value="#{searchController.criteria.testUID}" />
						</div>
					</div>

					<div class="control-group">
						<h:outputLabel class="control-label" for="testStartedFrom">Test started from</h:outputLabel>
						<div class="controls">
							<rich:calendar value="#{searchController.criteria.startedFrom}" datePattern="yyyy-MM-dd HH:mm" id="testStartedFrom" />
						</div>
					</div>

					<div class="control-group">
						<h:outputLabel class="control-label" for="testStartedTo">Test started to</h:outputLabel>
						<div class="controls">
							<rich:calendar value="#{searchController.criteria.startedTo}" datePattern="yyyy-MM-dd HH:mm" id="testStartedTo" />
						</div>
					</div>

					<div class="control-group">
						<h:outputLabel class="control-label" for="tags">Tags</h:outputLabel>
						<div class="controls">
							<h:inputText class="input-xlarge" id="tags" value="#{searchController.criteria.tags}" />
						</div>
					</div>

					<h:panelGroup rendered="#{searchController.criteria.parameters.isEmpty()}">
						<div class="control-group">
							<h:outputLabel class="control-label">Parameters</h:outputLabel>
							<div class="controls">
								<a4j:commandLink styleClass="btn btn-primary btn-small" render="@form" alt="Add parameter criteria" title="Add parameter criteria"
									action="#{searchController.addParameterCriteria}">
									<i class="icon-plus"></i>
								</a4j:commandLink>
							</div>
						</div>
					</h:panelGroup>
					<h:panelGroup rendered="#{!searchController.criteria.parameters.isEmpty()}">
						<div class="control-group">
							<h:outputLabel class="control-label">Parameters</h:outputLabel>
							<div class="controls">
								<h:dataTable value="#{searchController.criteria.parameters}" var="item">
									<h:column>
										<f:facet name="header">Name</f:facet>
										<h:inputText class="input-xlarge" value="#{item.name}" />
									</h:column>
									<h:column>
										<f:facet name="header">Value</f:facet>
										<h:inputText class="input-xlarge" value="#{item.value}" />
									</h:column>
									<h:column>
										<f:facet name="header">
											<a4j:commandLink styleClass="btn btn-primary btn-small" render="@form" alt="Add parameter criteria" title="Add parameter criteria"
												action="#{searchController.addParameterCriteria}">
												<i class="icon-plus"></i>
											</a4j:commandLink>
										</f:facet>
										<a4j:commandLink styleClass="btn btn-primary btn-small" render="@form" alt="Remove" title="Remove"
											action="#{searchController.removeParameterCriteria(item)}">
											<i class="icon-trash"></i>
										</a4j:commandLink>
									</h:column>
								</h:dataTable>
							</div>
						</div>
					</h:panelGroup>
				</fieldset>

				<div class="form-actions">
					<a4j:commandButton action="#{searchController.search}" value="Search" styleClass="btn btn-primary" alt="Search Test Execution"
						title="Search Test Execution" render="searchResult:searchResultTable">
						<f:param name="testExecutionSearchTO" value="#{searchController.criteria}" />
					</a4j:commandButton>
				</div>
			</h:form>

			<h:form id="searchResult">
				<rich:dataTable id="searchResultTable" styleClass="table table-bordered table-striped table-hover" value="#{searchController.result}" var="item">
					<rich:column sortable="true" sortOrder="#{searchController.sortsOrders['name']}" sortBy="#{item.name}">
						<f:facet name="header">
							<a4j:commandLink value="#{entityStrings.Test_id}" render="searchResultTable" action="#{searchController.sort()}">
								<f:param name="sortProperty" value="id" />
								<f:ajax render="searchResultTable" />
							</a4j:commandLink>
						</f:facet>
						<h:outputText value="#{item.id}" />
					</rich:column>
					<rich:column sortable="true" sortOrder="#{searchController.sortsOrders['name']}" sortBy="#{item.name}">
						<f:facet name="header">
							<a4j:commandLink value="#{entityStrings.TestExecution_name}" render="searchResultTable" action="#{searchController.sort()}">
								<f:param name="sortProperty" value="name" />
								<f:ajax render="searchResultTable" />
							</a4j:commandLink>
						</f:facet>
						<a href="/repo/exec/#{item.id}">#{item.name}</a>
					</rich:column>
					<rich:column sortable="true" sortOrder="#{searchController.sortsOrders['test']}" sortBy="#{item.test.name}">
						<f:facet name="header">
							<a4j:commandLink value="#{entityStrings.TestExecution_test}" render="searchResultTable" action="#{searchController.sort()}">
								<f:param name="sortProperty" value="test" />
								<f:ajax render="searchResultTable" />
							</a4j:commandLink>
						</f:facet>
						<a href="/repo/test/#{item.test.id}">#{item.test.name}</a>
					</rich:column>
					<rich:column>
						<f:facet name="header"></f:facet>
						<div class="btn-group">
							<a4j:commandLink styleClass="btn btn-primary btn-small" action="#{searchController.delete}" alt="#{strings.delete}" title="#{strings.delete}"
								render="@form :messagesPanel">
								<f:param name="idToDelete" value="#{item.id}" />
								<i class="icon-trash"></i>
							</a4j:commandLink>
							<a4j:commandLink styleClass="btn btn-primary btn-small" render=":compareMenuItem" lt="Add to comparison" title="Add to comparison"
								action="#{teComparatorSession.add(item.id)}">
								<i class="icon-plus"></i>
							</a4j:commandLink>
						</div>
					</rich:column>
				</rich:dataTable>
			</h:form>
		</ui:define>
	</ui:composition>
</h:body>
</html>