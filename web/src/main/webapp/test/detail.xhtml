<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:a4j="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:body>
	<f:metadata>
		<f:viewParam name="testId" value="#{testController.testId}" />
		<f:event type="preRenderView" listener="#{testController.preRender}" />
	</f:metadata>
	<ui:composition template="/layout/template.xhtml">
		<ui:define name="title">#{strings['page.test.title.details']}</ui:define>
		<ui:define name="content">
			<c:set target="#{testController}" property="editMode" value="#{false}" />
			<c:set target="#{testController}" property="createMode" value="#{false}" />
			<ui:include src="/test/metric_add.xhtml" />
			<ui:include src="/test/metric_edit.xhtml" />

			<fieldset>
				<legend>
					#{testController.test.name} <a href="/repo/test/#{testController.testId}/edit"><i class="icon-edit" title="#{strings.edit}" /></a>
				</legend>
				<h:outputLabel class="detail-label">ID</h:outputLabel>
				<div class="detail-value">#{testController.test.id}</div>
				<h:outputLabel class="detail-label">#{entityStrings.Test_uid}</h:outputLabel>
				<div class="detail-value">#{testController.test.uid}</div>
				<h:outputLabel class="detail-label">#{entityStrings.Test_groupid}</h:outputLabel>
				<div class="detail-value">#{testController.test.groupId}</div>
				<h:outputLabel class="detail-label">Description</h:outputLabel>
				<div class="detail-value">
					<h:outputText value="#{testController.test.description}" escape="false" />
				</div>
			</fieldset>


			<h3>Metrics</h3>

			<h:form id="metricList">
				<p>
					<a4j:commandLink styleClass="btn btn-primary btn-small" render=":dialogMetricAddAssignForm :dialogMetricAddCreateForm"
						action="#{testController.metricDetails.setEmptyMetric}" oncomplete="#{rich:component('dialogMetricAdd')}.show();"
						alt="#{strings['page.test.buAddMetric']}" title="#{strings['page.test.buAddMetric']}">
						<i class="icon-plus"></i> #{strings['page.test.buAddMetric']}
            </a4j:commandLink>
				</p>
				<ui:repeat value="#{testController.metricsList}" varStatus="status" var="item">
					<h4>#{item.name}</h4>
					<h:outputText escape="false" value="#{item.description}" />
					<div class="btn-group">
						<a4j:commandLink styleClass="btn btn-primary btn-small" alt="#{strings.delete}" title="#{strings.delete}"
							onclick="if (!confirm('Are you sure you want to delete metric (#{item.name})?') ) { return false;}; return true;"
							action="#{testController.metricDetails.deleteMetric(item)}" render="metricList :messagesPanel">
							<i class="icon-trash"></i> Delete
								</a4j:commandLink>

						<a4j:commandLink styleClass="btn btn-primary btn-small" render="dialogMetricEditForm" action="#{testController.metricDetails.setMetricForUpdate(item)}"
							oncomplete="#{rich:component('dialogMetricEdit')}.show();" value=" " alt="#{strings.edit}" title="#{strings.edit}">
							<i class="icon-edit"></i> Edit
								</a4j:commandLink>
					</div>
				</ui:repeat>

			</h:form>

		</ui:define>
	</ui:composition>
</h:body>
</html>